<!doctype html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Multi-company Guidelines &#8212; odoo 14.0 documentation</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/style.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/patchqueue.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/jquery.min.js"></script>
    <script src="../_static/bootstrap.js"></script>
    <script src="../_static/doc.js"></script>
    <script src="../_static/jquery.noconflict.js"></script>
    <script src="../_static/patchqueue.js"></script>
    <link href="https://fonts.googleapis.com/css?family=Work+Sans:500,600" rel="stylesheet">
    <link rel="canonical" href="" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Web Services" href="../webservices.html" />
    <link rel="prev" title="Profiling Odoo code" href="profilecode.html" /> 
  </head><body><header class="o_main_header o_has_sub_nav o_inverted ">
    <div class="o_main_header_main">
      <a class="pull-left o_logo" href="/"></a>
      <a href="#" class="o_mobile_menu_toggle visible-xs-block pull-right">
        <span class="sr-only">Toggle navigation</span>
        <span class="mdi-navigation-menu"></span>
      </a>
      <div class="o_header_buttons">
        <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
      </div>
      <ul class="o_primary_nav">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle">Apps</a>
          <div class="dropdown-menu o_secondary_nav">
            <div class="container">
              <div class="row">
                <div class="col-sm-3 o_website_apps">
                  <div class="o_nav_app_family">
                    <span></span> Websites
                    <div>Build great user experience</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/website-builder">Website Builder</a></li>
                    <li><a href="https://www.odoo.com/page/e-commerce">eCommerce</a></li>
                    <li><a href="https://www.odoo.com/page/blog-engine">Blogs</a></li>
                    <li><a href="https://www.odoo.com/page/community-builder">Forums</a></li>
                    <li><a href="https://www.odoo.com/page/slides">Slides</a></li>
                    <li><a href="https://adspike.odoo.com">SEA</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_sale_apps">
                  <div class="o_nav_app_family">
                    <span></span> Sales
                    <div>Boost your success rate</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/sales">Sales</a></li>
                    <li><a href="https://www.odoo.com/page/crm">CRM</a></li>
                    <li><a href="https://www.odoo.com/page/billing">Invoicing</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Point of Sale</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/point-of-sale">Shops</a></li>
                        <li><a href="https://www.odoo.com/page/pos-restaurant">Restaurants</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/subscriptions">Subscriptions</a></li>
                    <li><a href="https://www.odoo.com/page/sign">Sign</a></li>
                  </ul>
                </div>
                <div class="col-sm-3 o_operation_apps">
                  <div class="o_nav_app_family">
                    <span></span> Operations
                    <div>It's all about efficiency</div>
                  </div>
                  <ul>
                    <li><a href="https://www.odoo.com/page/accounting">Accounting</a></li>
                    <li><a href="https://www.odoo.com/page/project-management">Project</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Human Resources</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/recruitment">Recruitment</a></li>
                        <li><a href="https://www.odoo.com/page/employees">Employees</a></li>
                        <li><a href="https://www.odoo.com/page/expenses">Expenses</a></li>
                        <li><a href="https://www.odoo.com/page/appraisal">Appraisal</a></li>
                        <li><a href="https://www.odoo.com/page/fleet">Fleet</a></li>
                        <li><a href="https://www.odoo.com/page/leaves">Leaves</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/warehouse">Inventory</a></li>
                    <li><a href="https://www.odoo.com/page/purchase">Purchase</a></li>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Manufacturing</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/manufacturing">MRP</a></li>
                        <li><a href="https://www.odoo.com/page/plm">PLM</a></li>
                        <li><a href="https://www.odoo.com/page/maintenance">Maintenance</a></li>
                        <li><a href="https://www.odoo.com/page/quality">Quality</a></li>
                      </ul>
                    </li>
                  </ul>
                </div>
                <div class="col-sm-3 o_productivity_apps">
                  <div class="o_nav_app_family">
                    <span></span> Productivity Tools
                    <div>Great Tools = Happy People</div>
                  </div>
                  <ul>
                    <li class="dropdown">
                      <a href="#0" class="dropdown-toggle">Communication</a>
                      <ul>
                        <li><a href="https://www.odoo.com/page/discuss">Discuss</a></li>
                        <li><a href="https://www.odoo.com/page/discuss-groups">Mailing Lists</a></li>
                        <li><a href="https://www.odoo.com/page/notes">Notes</a></li>
                        <li><a href="#">Help desk</a></li>
                        <li><a href="#">Appointment</a></li>
                      </ul>
                    </li>
                    <li><a href="https://www.odoo.com/page/timesheet">Timesheet</a></li>
                    <li><a href="https://www.odoo.com/page/email-marketing">Email Marketing</a></li>
                    <li><a href="https://www.odoo.com/page/events">Events</a></li>
                    <li><a href="https://www.odoo.com/page/survey">Survey</a></li>
                    <li><a href="https://www.odoo.com/page/live-chat">Live Chat</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <a href="http://www.odoo.com/apps/modules" class="o_store_link"><i class="fa fa-cube fa-fw"></i> Third party apps</a>
          </div>
        </li>
        <li><a href="https://www.odoo.com/page/tour">Tour</a></li>
        <li><a href="https://www.odoo.com/pricing">Pricing</a></li>
        <li><a href="https://www.odoo.com/page/docs">Docs</a></li>
      </ul>
    </div>
    <nav class="navbar o_sub_nav">
      <div class="container">
        <div class="navbar-header visible-xs">
            <button type="button" class="navbar-toggle collapsed text-left btn-block" data-toggle="collapse" data-target="#o_sub-menu" aria-expanded="false">
              Navigate
              <span class="mdi-hardware-keyboard-arrow-down pull-right"></span>
            </button>
        </div>

        <div class="collapse navbar-collapse" id="o_sub-menu">
          <ol class="o_breadcrumb breadcrumb nav navbar-left">
              
              





    
        
            <li><a href="../index.html">Developer Doc</a></li>
        
    
    <li class="active"><a href="#">Multi-company Guidelines</a></li>

              
          </ol>

          <div class="call-to-action navbar-right hidden-xs">
            <a href="http://www.odoo.com/trial" class="btn btn-primary">Start Now</a>
          </div>

          <ul class="navbar-nav navbar-right nav o_sub_nav_actions">
            
              <li class="divider"></li>
            

            
            


            
          </ul>

          <ul class="nav navbar-nav navbar-right">
            

            
            

<li><a href="https://www.odoo.com/documentation/user/14.0/index.html">User</a></li>
<li><a href="https://www.odoo.com/documentation/14.0/index.html">Developer</a></li>
<li><a href="https://www.odoo.com/documentation/14.0/setup/install.html">Installation</a></li>
<li><a href="https://odoo.com/slides">eLearning</a></li>
<li><a href="https://www.odoo.com/page/odoo-white-paper">White Papers</a></li>
<li><a href="https://www.odoo.com/page/legal">Legal</a></li>
<li id="searchbox" style="display: none; margin: 0 0 0 10px;" role="search">
    <form class="search form-inline input-group-sm" action="../search.html" method="get">
        <input type="text" class="form-control" name="q" id="q" placeholder="Search..." />
        <input type="hidden" name="area" value="default" />
        <input type="hidden" name="check_keywords" value="yes" />
        <button type="submit" value="Go" class="btn btn-default btn-sm">Go</button>
    </form>
</li>
<script type="text/javascript">$('#searchbox').show(0);</script>
            

            
          </ul>
        </div>
      </div>
    </nav>
  </header><div id="wrap" class="">
    
    
    
    <figure class="card top has_banner">
      <span class="card-img" style="background-image: url('../_static/banners/company.jpg');"></span>
      <div class="container text-center">
        <h1> Multi-company Guidelines </h1>
      </div>
    </figure>
    
    
    
      <main class="container ">
        
        <div class="o_content row">
          
          <aside>
            <div class="navbar-aside text-center">
              <ul class="text-left list-group nav"><li class="list-group-item"><a href="#company-dependent-fields" class="ripple reference internal">Company-dependent fields</a></li><li class="list-group-item"><a href="#multi-company-consistency" class="ripple reference internal">Multi-company consistency</a></li><li class="list-group-item"><a href="#default-company" class="ripple reference internal">Default company</a></li><li class="list-group-item"><a href="#views" class="ripple reference internal">Views</a></li><li class="list-group-item"><a href="#security-rules" class="ripple reference internal">Security rules</a></li></ul>
              
              <p class="gith-container"><a href="https://github.com/odoo/odoo/edit/14.0/doc/howtos/company.rst" class="gith-link">
                  Edit on GitHub
              </a></p>
              
            </div>
          </aside>
          
          <article class="doc-body ">
            
            
  <section id="multi-company-guidelines"><i id="reference-howtos-company"></i><div role="alert" class="alert alert-warning"><h3 class="alert-title">Warning</h3><p >This tutorial requires good knowledge of Odoo.
Please refer to the <a href="backend.html#howto-base" class="alert-link reference internal"><span class="std-ref std">basic tutorial</span></a> first if needed.</p></div><p >As of version 13.0, a user can be logged in multiple companies at once. This allows the user to
access information from multiple companies but also to create/edit records in a multi-company
environment.</p><p >If not handled correctly, it may be the source of a lot of inconsistent multi-company behaviors.
For instance, a user logged in both companies A and B could create a sales order in company A and
add products belonging to company B to it. It is only when the user will log out from company B that
access errors will occur for the sales order.</p><p >To correctly manage multi-company behaviors, Odoo’s ORM provides multiple features:</p><ul ><li ><a href="#howto-company-company-dependent" class="reference internal"><span class="std-ref std">Company-dependent fields</span></a></li><li ><a href="#howto-company-check-company" class="reference internal"><span class="std-ref std">Multi-company consistency</span></a></li><li ><a href="#howto-company-default-company" class="reference internal"><span class="std-ref std">Default company</span></a></li><li ><a href="#howto-company-views" class="reference internal"><span class="std-ref std">Views</span></a></li><li ><a href="#howto-company-security" class="reference internal"><span class="std-ref std">Security rules</span></a></li></ul></section><section id="company-dependent-fields"><i id="howto-company-company-dependent"></i><h2 >Company-dependent fields</h2><p >When a record is available from multiple companies, we must expect that different values will be
assigned to a given field depending on the company from which the value is set.</p><p >For the field of a same record to support several values, it must be defined with the attribute
<code >company_dependent</code> set to <code >True</code>.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">api</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Record</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;record.public&#39;</span>

    <span class="n">info</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">()</span>
    <span class="n">company_info</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">company_dependent</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">display_info</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Text</span><span class="p">(</span><span class="n">string</span><span class="o">=</span><span class="s1">&#39;Infos&#39;</span><span class="p">,</span> <span class="n">compute</span><span class="o">=</span><span class="s1">&#39;_compute_display_info&#39;</span><span class="p">)</span>

    <span class="nd">@api</span><span class="o">.</span><span class="n">depends_context</span><span class="p">(</span><span class="s1">&#39;company&#39;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">_compute_display_info</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
            <span class="n">record</span><span class="o">.</span><span class="n">display_info</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">info</span> <span class="o">+</span> <span class="n">record</span><span class="o">.</span><span class="n">company_info</span>
</pre></div>
</div>
<div role="alert" class="alert alert-info"><h3 class="alert-title">Note</h3><p >The <code >_compute_display_info</code> method is decorated with <code >depends_context('company')</code>
(see <a href="../reference/orm.html#odoo.api.depends_context" title="odoo.api.depends_context" class="alert-link reference internal"><code class="xref py-attr py">depends_context</code></a>) to ensure that the computed field is recomputed
depending on the current company (<code >self.env.company</code>).</p></div><p >When a company-dependent field is read, the current company is used to retrieve its value. In other
words, if a user is logged in companies A and B with A as main company and creates a record for
company B, the values of company-dependent fields will be that of company A.</p><p >To read the values of company-dependent fields set from another company than the current one, we need
to ensure the company we are using is the correct one.  This can be done with <a href="../reference/orm.html#odoo.models.Model.with_company" title="odoo.models.Model.with_company" class="reference internal"><code class="xref py-meth py">with_company()</code></a>,
which updates the current company.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="c1"># Accessed as main company (self.env.company)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">company_dependent_field</span>

<span class="c1"># Accessed as desired company (company_B)</span>
<span class="n">val</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">with_company</span><span class="p">(</span><span class="n">company_B</span><span class="p">)</span><span class="o">.</span><span class="n">company_dependent_field</span>
<span class="c1"># record.with_company(company_B).env.company == company_B</span>
</pre></div>
</div>
<div role="alert" class="alert alert-warning"><h3 class="alert-title">Warning</h3><p >Whenever you are computing/creating/… things that may behave differently
in different companies, you should make sure whatever you are doing is done
in the right company. It doesn’t cost much to always use <code >with_company</code> to
avoid problems later on.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="nd">@api</span><span class="o">.</span><span class="n">onchange</span><span class="p">(</span><span class="s1">&#39;field_name&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_onchange_field_name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
 <span class="bp">self</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">with_company</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">company_id</span><span class="p">)</span>
 <span class="o">...</span>

<span class="nd">@api</span><span class="o">.</span><span class="n">depends</span><span class="p">(</span><span class="s1">&#39;field_2&#39;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">_compute_field_3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
 <span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="bp">self</span><span class="p">:</span>
   <span class="n">record</span> <span class="o">=</span> <span class="n">record</span><span class="o">.</span><span class="n">with_company</span><span class="p">(</span><span class="n">record</span><span class="o">.</span><span class="n">company_id</span><span class="p">)</span>
   <span class="o">...</span>
</pre></div>
</div>
</div></section><section id="multi-company-consistency"><i id="howto-company-check-company"></i><h2 >Multi-company consistency</h2><p >When a record is made shareable between several companies by the mean of a <code >company_id</code> field, we
must take care that it cannot be linked to the record of another company through a relational field.
For instance, we do not want to have a sales order and its invoice belonging to different companies.</p><p >To ensure this multi-company consistency, you must:</p><ul ><li >Set the class attribute <code >_check_company_auto</code> to <code >True</code>.</li><li >Define relational fields with the attribute <code >check_company</code> set to <code >True</code> if their model has a
<code >company_id</code> field.</li></ul><p >On each <a href="../reference/orm.html#odoo.models.Model.create" title="odoo.models.Model.create" class="reference internal"><code class="xref py-meth py">create()</code></a> and <a href="../reference/orm.html#odoo.models.Model.write" title="odoo.models.Model.write" class="reference internal"><code class="xref py-meth py">write()</code></a>, automatic checks
will be triggered to ensure the multi-company consistency of the record.</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Record</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;record.shareable&#39;</span>
    <span class="n">_check_company_auto</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">company_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;res.company&#39;</span><span class="p">)</span>
    <span class="n">other_record_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;other.record&#39;</span><span class="p">,</span> <span class="n">check_company</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<div role="alert" class="alert alert-info"><h3 class="alert-title">Note</h3><p >The field <code >company_id</code> must not be defined with <code >check_company=True</code>.</p></div><section class="code-method py"><h6 id="odoo.models.Model._check_company"><code>Model._check_company(<em><span class="n">fnames</span><span class="o">=</span><span class="default_value">None</span></em>)<a href="https://github.com/odoo/odoo/blob/14.0/odoo/models.py#L3247" class="external alert-link reference"><span class="viewcode-link">[source]</span></a></code></h6><p >Check the companies of the values of the given field names.</p><div class="code-fields"><div class="code-field"><div class="code-field-name">Parameters</div><div class="code-field-body"><strong >fnames</strong> (<a href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.9)" class="external alert-link reference"><code >list</code></a>) – names of relational fields to check</div></div><div class="code-field"><div class="code-field-name">Raises</div><div class="code-field-body"><a href="../reference/orm.html#odoo.exceptions.UserError" title="odoo.exceptions.UserError" class="alert-link reference internal"><strong >UserError</strong></a> – if the <code >company_id</code> of the value of any field is not
in <code >[False, self.company_id]</code> (or <code >self</code> if
<code class="xref py-class py">res_company</code>).</div></div></div><p >For <code class="xref py-class py">res_users</code> relational fields,
verifies record company is in <code >company_ids</code> fields.</p><p >User with main company A, having access to company A and B, could be
assigned or linked to records in company B.</p></section><div role="alert" class="alert alert-warning"><h3 class="alert-title">Warning</h3><p >The <code >check_company</code> feature performs a strict check ! It means that if a record has no
<code >company_id</code> (i.e. the field is not required), it cannot be linked to a record whose
<code >company_id</code> is set.</p></div><div role="alert" class="alert alert-info"><h3 class="alert-title">Note</h3><p >When no domain is defined on the field and <code >check_company</code> is set to <code >True</code>, a default domain is
added: <code >['|', '('company_id', '=', False), ('company_id', '=', company_id)]</code></p></div></section><section id="default-company"><i id="howto-company-default-company"></i><h2 >Default company</h2><p >When the field <code >company_id</code> is made required on a model, a good practice is to set a default
company. It eases the setup flow for the user or even guarantees its validity when the company is
hidden from the view. Indeed, the company is usually hidden if the user does not have access to
multiple companies (i.e. when the user does not have the group <code >base.group_multi_company</code>).</p><div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">odoo</span> <span class="kn">import</span> <span class="n">api</span><span class="p">,</span> <span class="n">fields</span><span class="p">,</span> <span class="n">models</span>

<span class="k">class</span> <span class="nc">Record</span><span class="p">(</span><span class="n">models</span><span class="o">.</span><span class="n">Model</span><span class="p">):</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s1">&#39;record.restricted&#39;</span>
    <span class="n">_check_company_auto</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="n">company_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span>
        <span class="s1">&#39;res.company&#39;</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="k">lambda</span> <span class="bp">self</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">company</span>
    <span class="p">)</span>
    <span class="n">other_record_id</span> <span class="o">=</span> <span class="n">fields</span><span class="o">.</span><span class="n">Many2one</span><span class="p">(</span><span class="s1">&#39;other.record&#39;</span><span class="p">,</span> <span class="n">check_company</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</section><section id="views"><i id="howto-company-views"></i><h2 >Views</h2><p >As stated in <a href="#howto-company-default-company" class="reference internal"><span class="std-ref std">above</span></a>, the company is usually hidden
from the view if the user does not have access to multiple companies. This is tested with the group
<code >base.group_multi_company</code>.</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.ui.view&quot;</span> <span class="na">id=</span><span class="s">&quot;record_form_view&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>record.restricted.form<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model&quot;</span><span class="nt">&gt;</span>record.restricted<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;arch&quot;</span> <span class="na">type=</span><span class="s">&quot;xml&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;form&gt;</span>
            <span class="nt">&lt;sheet&gt;</span>
                <span class="nt">&lt;group&gt;</span>
                    <span class="nt">&lt;group&gt;</span>
                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;company_id&quot;</span> <span class="na">groups=</span><span class="s">&quot;base.group_multi_company&quot;</span><span class="nt">/&gt;</span>
                        <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;other_record_id&quot;</span><span class="nt">/&gt;</span>
                    <span class="nt">&lt;/group&gt;</span>
                <span class="nt">&lt;/group&gt;</span>
            <span class="nt">&lt;/sheet&gt;</span>
        <span class="nt">&lt;/form&gt;</span>
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
</section><section id="security-rules"><i id="howto-company-security"></i><h2 >Security rules</h2><p >When working with records shared across companies or restricted to a single company, we must take
care that a user does not have access to records belonging to other companies.</p><p >This is achieved with security rules based on <code >company_ids</code>, which contains the current companies of
the user (the companies the user checked in the multi-company widget).</p><div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- Shareable Records --&gt;</span>
<span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.rule&quot;</span> <span class="na">id=</span><span class="s">&quot;record_shared_company_rule&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Shared Record: multi-company<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;model_record_shared&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;global&quot;</span> <span class="na">eval=</span><span class="s">&quot;True&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;domain_force&quot;</span><span class="nt">&gt;</span>
        [&#39;|&#39;, (&#39;company_id&#39;, &#39;=&#39;, False), (&#39;company_id&#39;, &#39;in&#39;, company_ids)]
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
<div class="highlight-xml"><div class="highlight"><pre><span></span><span class="c">&lt;!-- Company-restricted Records --&gt;</span>
<span class="nt">&lt;record</span> <span class="na">model=</span><span class="s">&quot;ir.rule&quot;</span> <span class="na">id=</span><span class="s">&quot;record_restricted_company_rule&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;name&quot;</span><span class="nt">&gt;</span>Restricted Record: multi-company<span class="nt">&lt;/field&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;model_id&quot;</span> <span class="na">ref=</span><span class="s">&quot;model_record_restricted&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;global&quot;</span> <span class="na">eval=</span><span class="s">&quot;True&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;field</span> <span class="na">name=</span><span class="s">&quot;domain_force&quot;</span><span class="nt">&gt;</span>
        [(&#39;company_id&#39;, &#39;in&#39;, company_ids)]
    <span class="nt">&lt;/field&gt;</span>
<span class="nt">&lt;/record&gt;</span>
</pre></div>
</div>
</section>

          </article>
        </div>
        
        <div id="mask"></div>
      </main>
  </div>

  <div class="floating_action_container">
    <a id="floating_action" class="ripple" href="#">
      <i class="mdi-action-explore"></i>
    </a>
    <div id="floating_action_menu">
      <span class="bubble"></span>
      <ul class="list-group content">
        <li class="list-group-item ripple"><a>Cras justo odio</a></li>
        <li class="list-group-item ripple"><a>Dapibus ac facilisis in</a></li>
        <li class="list-group-item ripple"><a>Morbi leo risus</a></li>
        <li class="list-group-item ripple"><a>Porta ac consectetur ac</a></li>
        <li class="list-group-item ripple"><a>Vestibulum at eros</a></li>
      </ul>
    </div>
  </div>
  <footer>
    <div id="footer" class="container">
      <span class="o_logo o_logo_inverse center-block o_footer_logo"></span>
      <div class="row">
        <div class="col-sm-7 col-md-7 col-lg-6">
          <div class="row">
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Community</span>
              <ul>
                <li><a href="https://github.com/odoo/odoo">Github</a></li>
                <li><a href="http://www.odoo.com/page/download">Download</a></li>
                <li class="divider"></li>
                <li><a href="https://runbot.odoo.com">Runbot</a></li>
                <li><a href="https://github.com/odoo/odoo/wiki/Translations">Translations</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/odoo-community">Mailing Lists</a></li>
                <li><a href="http://www.odoo.com/forum/help-1">Forum</a></li>
              </ul>
            </div>
            <div class="col-xs-6 col-sm-4">
              <span class="menu_title">Services</span>
              <ul>
                <li><a href="https://www.odoo.sh">Odoo Cloud Platform</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/help">Support</a></li>
                <li><a href="https://upgrade.odoo.com">Upgrade</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/partners">Find a partner</a></li>
                <li><a href="http://www.odoo.com/page/become-a-partner">Become a partner</a></li>
                <li class="divider"></li>
                <li><a href="http://training.odoo.com/courses/odoo-functional">Training Center</a></li>
                <li><a href="http://www.odoo.com/page/education-program">Education</a></li>
                <li class="divider"></li>
                <li><a href="http://www.odoo.com/page/security">Security</a></li>
              </ul>
            </div>
            <div class="col-xs-12 col-sm-4 mb64">
              <span class="menu_title">About us</span>
              <ul>
                <li><a href="http://www.odoo.com/page/about-us">Our company</a></li>
                <li><a href="http://www.odoo.com/page/contactus">Contact</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/event">Events</a></li>
                <li><a href="http://www.odoo.com/blog">Blog</a></li>
                <li><a href="http://www.odoo.com/blog/6">Customers</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/jobs">Jobs</a></li>
                <li class="divider" />
                <li><a href="http://www.odoo.com/page/legal">Legal</a> | <a href="http://www.odoo.com/privacy">Privacy</a></li>
              </ul>
            </div>
          </div>
        </div>
        <div class="col-sm-5 col-md-4 col-md-offset-1 col-lg-5 col-lg-offset-1">
          <p>
            <small>
              Odoo is a suite of open source business apps that cover all your company needs: CRM, eCommerce, accounting, inventory, point of sale, project management, etc.
              <br/><br/>
              Odoo's unique value proposition is to be at the same time very easy to use and fully integrated.
            </small>
          </p>
        </div>
      </div>
    </div>
    <div class="o_footer_bottom">
      <div class="container">
        <a class="small" href="http://www.odoo.com/page/website-builder">Website made with <span class="o_logo o_logo_inverse o_logo_15"></span></a>
        <div class="social-links pull-right">
          <a href="http://www.odoo.com/web/about/facebook"><i class="fa fa-facebook"></i></a>
          <a href="http://www.odoo.com/web/about/twitter"><i class="fa fa-twitter"></i></a>
          <a href="http://www.odoo.com/web/about/linkedin"><i class="fa fa-linkedin"></i></a>
          <a href="mailto:info@odoo.com"><i class="fa fa-envelope"></i></a>
        </div>
      </div>
    </div>
  </footer>
  </body>
</html>